from Crypto.Cipher import AES



class AESDecrypt:
    iv = '0123456789ABCDEF'
    key = 'jo8j9wGw%6HbxfFn'

    @classmethod
    def _pkcs7unpadding(cls, text):
        """
        处理使用PKCS7填充过的数据
        :param text: 解密后的字符串
        :return:
        """
        length = len(text)
        unpadding = ord(text[length - 1])
        return text[0:length - unpadding]

    @classmethod
    def decrypt(cls, content):
        """
        AES解密，模式cbc，去填充pkcs7
        :param content: 16进制编码的加密字符串
        :return: 返回解密后的字符串
        """
        key = bytes(cls.key, encoding='utf-8')
        iv = bytes(cls.iv, encoding='utf-8')
        cipher = AES.new(key, AES.MODE_CBC, iv)
        decrypt_bytes = cipher.decrypt(bytes.fromhex(content))
        result = str(decrypt_bytes, encoding='utf-8')
        result = cls._pkcs7unpadding(result)
        return result


def timestamp(time_data):
    """

    :param time_data: 毫秒级时间戳
    :return: 格式化后时间戳
    """
    timeStamp = time_data / 1000
    dateArray = datetime.datetime.fromtimestamp(timeStamp)

    otherStyleTime = dateArray.strftime("%Y--%m--%d %H:%M:%S")
    return otherStyleTime





if __name__ == '__main__':
    c = '95780ba0943730051dccb5fe3918f9fe1b6f2130681f99d5620c5497aa480f1354ce3b0126bc549ede81c290cc580a9d2561da4c5a9e55b15aa1826c2614000aafed108a2c204e51f0ffd99d9783118bb7df11668936f5ad5d81beec984c12c0c53d1e566ec5dac11d71d56f915ca8acb959e836d099c6ef0aa876fed9511e1d98bf60c8cafa6a250475ab7635f3e15baef3327a460e118f55c784c6750949b08a96acf5f240fcf8cbe2a2dade0b9d76240a137cf566e8f114343dec711170f2f024bc09c1909fe0f8613de5683efbbff47b3afaaf0ffef638aa15a79d9e68d9e4766cb8633312f67ef62095cac61407d9701ffccf67d9844b6b2a1dc1efc5af0d1630cbb9bc7dd36e842bed34d08995671acfc41192e9bffb10f9d274639cc032d0b294b803265c2b0d13afbeba9870132d7ceb712c65147133b302518ad3df99f5105614174fd8bb0bd1dc249ee9355a14db550f46ae300d7c6158342fb1ffbad9a24136633dab652f4c494127253d9c9ea53ab36a79061e61ed9938773407cd2193f3c31e57300f00f1fad7eea7d65bd125b6ac1154229a487f70b5ad98360059418d9d01648a37eacee40a0fcaeade7803bd2c7367d9e924e2adb810df265cb0aeb0245a25e357f73a08f2d9b102b405f716ef42f91f262dce8ac5676bbbd4077231757bc0066a63b9a77e1fac42fc8795d3ec530ba4a8be0b093df3e7ee5dfbee6a9e80c67510200a03a73439f240236d2e72ac2d02e55c0bef1a185220fe81ac2c91422dd7a0916422d8dd2a209d050bf2570e7f2e58a975eeba716c382c9ca8725c6fb62a1d6df71f9e6a39184adf57325ec0c5ac3c16771e05b27f616c62e88e65619f90582cbcfb6e42e3a6ea5cd83debb26ff4b8d432216de0d0480ee5d8dbcf124a0c94a5d60349ff5e4817a332d66ec762c7435794cc87e4037b71ca23d76a8363323cb6cca9b4f006bea0334e707b3301ea4da961c530386dfb651310ce4247768fa304916b73f52c9122563bb15d973328305341352501c629cfd791b74ed97bcd832d0798022d8ae3acca70dc66a43a53199131c82970e941f3253cf09dcae9c468c819a8cd3eaeb533248d3319b3d73eb207f8ec69bf4970b878508e1bb365fcc6d82f64407a587940e1be7128eedc8d7b386b5daac52a9b226c3d56e4812428a2b2e3141370ff00e958a6f1299911cfda9651267caf51d8aa94656967e2ed11143560d26353848be0c60a3aab003fde459660292272e42a9ec340460a7da39fd695958c356a311df933291468f9db8e31eeddb74276c804d797dc713c043af68e655a94bc100c4029de399a52c84005f08aa6200143e2dbc20e1e3d6ca290ce168d5cb7d9e3c69a56a8a188abb32851f4fdfdb4c8d93609d57c4855aad03a467a0e6ef59b3d37cff3322652da1ea688582a01c2a21195d6de54ec329ccb18e0174ce4ddf92f1efd5b127835c08b502cbb8c612a0f117f64b48ed8c1785415bfc5b29643d114aa3e00124fe30f25770d18481217f1e61d68caeffac794ea3ae5f26b9db4dcfe4a41d961ed788353c5f2c8e50d3bb83e55f48e201dc456b37d91c37cb84151a1986720f286c121e579f7beaaefaf8395d81a202934ecf46a430b3fa2fd263ca62b65ae2e4f5eb87a9281bd8e05353392a2bca639aa3633abdae0757cdce065a23814aa4ade645a38e3d4674543ad7d71f4267d5449a3b8cdaf0056a9341f8c87c656965d0b94cb18a997b4e2357e3be12f1f0c63b2663638a7e678146a2e8fc7836c90137af8fd6df79d01a559ab898780f8262efb8f8c0da0c8d5ce5b3f22df5e533eccd8fc442fd333b1fc4419b6be75693d1c46c5882a84bc3b8725de4cbc18835b82efed0c0cbb63ed2f0765ed8c0e242aa5d15d327019d8fc434b17274d9d03c8a2c7fa29d1c04a2273e76b25a28997df2fa3a8dc07d6e8560a805968467602da6478f45ce695a8fcf886de34d02bfd8d290d1475aebda95e9c07750a98c83b596c6c6c1433a00de563b2f6260c98b04acf8725ed68bd7aa400a700334d554d57faa9233e4af076ed178116259fef210e1407656e73861fb4f5ab18b8f5f388082ca425d247ba470d6f0f34e410822d513b2843724b35f72e363e40c2f40a30e01d74fea6e2fc869bd9624a6fb1d33940a0f91a07f8029dcbd15a41ad6f581f5fff572df5187cafe184261cf5256c7b6d419abdaf4bdfafd8476ad5733a8177f1bdedb56986cfe80ce9f60a7a013966e4f1129011e03c9a626cd6751241ccdfec579552670b67d6370304f8ce511cfcf9c8dcef0006e8f0763d389535d60486a3aea09981ee0992b8ee41e53009c891bd6aa775b96b841d50d7eebdca25a7b5aa658aac49c1f69d2ecf08fc66ae14241e56177cd642d1ab8692cb0617da2b4e909a49eb94a21650062d436ba790787a8f182fc09b3491ea9a8726760f904ec9d0756374951862eaee99092623390c6343d9918a5e6f0adfd1f66381e43a951784ed76db9c1539f0d70b7da221aa3ff14347ff9ac849030e81a0cd102c1da271133c520d43bbfea2ecd80cfecdd1da6c0b8689fb90723db5295e0763c1e42c13e1b7064b4e5188b0630084775a79bf4b26046e6d065cd34c1a3ffe031b78787fa6a04ad147497b1f812ab3267edf5d2a529c3e44e908eb75799acdfc0f693fb28cbef18a4355fcf49a5d1c0b93640057dbd9ac326dcc8567d61231672778b3496c2af76d9d3aac56be288e0e05485134329e18f32b1ffc46d4af0e8f4abd3e25cc4865b581ac6c12becee3e05470f9a916428edd352e3bffd3718eae87497d830726b0c8f5bec8153aa3daf601d5106686fb37b62766cd2d75687fc100066efc6e17cf27a75cd14b9ddf5d525b268d08a9684dc321747a73cf33e4f85b4575347bca68bb7f5148359441a3c1652ad47336fcce5ac440e428de6e74bf28b380c747694bc11d7df642631b489408c9982bbd89dc4c2aa5c0b29b498aab7e3725d91f46acd477ed76752c9ec162dd624da78b8b9cd854d20b35326f7e309ddc3163e5f5c4a804de71b117f63610d9110da9a7dd372d1500166ea616d196266caa739176254d4f29def6fabdfb45743d5ec9372bc73d4802bb64a70f3fc59d30e219517189ee8f94a634b76ef1228b680b3c454b1e018bfce744367ff6e2b48f5bb163e8dbbef79288a020f9757ba12d5343afeafb0dbde5aefb3293de04e32add2bc18ad3fccd2c09396eca6440bf4113b11319a119e15ecd3040f888c0eaa39cdb2273ca1f0870c7ebb976b6088731014659310e320ba3b895d308e7a70276ac2d807c49bad22a26b002ba25eaa0d6de89be363717fd42ba86bcae19cae6fabd307c9674e7e8412a3615ae93bd43111b7b558329cd8c13a00831197fa1b22f4daa3ff960d2be9c3f8bc4d4d984d6b371f057b306a52fc1a2e3542230823a3f094ad273aa9328b08dc736f3186e8920ec5302d9d862630a75c5cea3e71ac47774d8b3bc6d99e1c0db34283a012f3ba948a390c749f9ef5f669830c3f41c74431a6ff8b079e595fb1c0d8e6f851dc466bd296a7b99032cd85b1736d5371270f8abebd7f87aefb5fc07f2360d35d74a400d5eafb174ad4fc9806005de873f3d36995b36d34e70b1a6fd1e10b508e305f858ccd67ab65e3cab0afeba2c619109ebc4b36e1cdd39e89366688d38cdbec40b4f7743099ca41a01dfa09256d1e46a25befe6086cda5d774c5159b89b0f2d6b2a4be79cf201ea4cf6d5107c59ba9046f800a34ec1bbd3ff7fc2fc6ad17318509393854d66fe2ba8428618e09f11004786e0fab425f9ff4200d51a2f4ada9c332da176d46aa630f3036358d575ed7f634cb5f59add57ce8c078f0f89bab28cabdd2a7216e923d595b538e5d15de9cecfe2fbe5ed8540c3d9d8c67a773a97c4702c921391addbe34248643aec231d8de186223eaa401c5280513a1cd38ae000410d4c70585a42bdc6e0f88b30b436a048fb161d68020f0398d1890bcdf3af5a15789decc309a98cd3848e65571007c96727a72e1be235d7c8a7e832bd1171a548d78c34edc029083e5dedbdd9e8ea116f8467a0594f7325a037bceaef6e726ea0a4c92c5782628bcc95e55fb792d509697be08ea7a5bffc62df5cedf2358434d03697c47f83589969a6db41a25d731eae5425e856d41f0cef9df7790921c4c28c9854ec34cb8f67e6caa98327ca68589cfff17d90ea78d2bf7c1044b9dffe88612ec37c46f65ca3a4ad2c2896b86ebc72932bd9a89efd410324b33ac1fded45b61d4b90d90ed8953de058cda6cdfbc89e010a8d9b55cce4c7c742cc50878517270a53f243a602b2cb571039306d07b2c596b683e546daf269fc2a82bceeb221526595133bfe8bdb39bc355bd9e5a4729bd78884d42115441579737fc4129554997db784aa1a353568266c4ac1cac1c386ea3e9c5771c9f5e3520ccdc411083a11c2747df8af6034a77410bccca21389e63528376911ecc595b68c22555cd529494839f59f8a7c9f8f1389a23c6d42f3f7ec17eaeaa9eeff1c031846cdf081953a9f58fd5f8db8773bc306f91da32f6c40953665ae199b678bbdab88bf84ef5002ba05bcef2506bd2fda2004ed6741a81bff6199df1d809d8fd191ef709f5597eef6e81f9ebe277a6da9f05e67b2968b37f26f9e526bddad068f6c88cc752ccc84b95cd000373ba3562f99073f388f334003a9d8a71cc4508f7aa72d05b407aa0d5418b109b4f83d18ab93ff3a6a291da6382f40e74e14d4fbb729f2bf2dc039ee37aabf62905f93576fc9f3892483e08df0398fdbac458b8a326c5656106718b73bd0fd4ff860a5c093f826cba90e7c196a9062047a4f23a2216eccb6e5b5c66af181488628e51b29f35878a7c7dc4ed524928219e8da9d575892e9ed63645971f46ef42d39e5b96f12e024764785f6b56cfb8acddb615d98da7f7812a042b9f9660ccfaa374590e42b22c6e9fba396e0ea0ca2cc6540cd246b8b88e452838340faf76c1a0946bd534ddbda86fdaad28a99cec3289a9989b9f092869f0f8ebaaa4be380710918c45355996efba70b6af70a8082fdccf213381def7712207708146677c0b388ac23de1baf5b5a78243f48c5cfd34797d675781f6e57da88c819a328d443cfc1f823ce7350a418470b10dcc896c6ec5011d24803cbce2925d9de28786bc1b3798164f4f7c8e8cbb90f72137f6cf31c47e0f1ba01a7c8027b06a9b18ee49ded047ff7bc5774c4a1decaca794be2cfd26306525886d35fc394f7c83dca94b27c138d1ee7dc835a187d1166210efa40d00dbd80f70c1bd6bddb8574e0540b1033b293a0fc22667407192b92564e67d4c237b8df7b3974bbcee3619fc74d9f6d6aadbb0f11311391f7b0c570f5f057dc3575548d58eccf3971bfb342afa8913f62765840026f562939de6a6ba80305b9bf5ceaea3b87a996d40bd3722cfeb7d226fdb7d08be11251fa840555b7470de434a036fdcfb31f7505a82bf16fc92fc3b4797422b12ccf3348cf67f14c073ce750eaadfdad0b86e68d537f15e58875d99361da0a8ea53de6f7e0010a7bdf780b8441ff2baf539bea0b345ed4e96a59dc7f1447b50391ea8e83fc9774db4682160ef7b8e3afde431f116f86dc5463ed571e2c213d0726adda2aafea9c7344135c52ce7eddd25c1109c06600402f513811a90677dcf89b60e6dc22679f613523520e4a8c8a62f75d4ab9e39817ca18692b809cc9037384449243e28e75f69f13148c90f651351e54e704c34e204a72cdba893bc64914387e2c388fddde89e53b2910bc4130580f3217d5c5ed5b62f99abc4dbe14b139280875f4b59cbdeae08117672419d99764d6da0b080c69f5d11915808ec34dacc7677ec4eece1bba5aabc5e493e526f19dc795c1ea9ce87246e3243c644ab9a1b053a63df44e2c5cc98e282fd504284b3e492099cdee9e88cc7ae3f538d325808fbde03f984a8cfeccd32d47f33b7b58b17655221af07d27a67cde9d500ccd4c2e7db7c478431cfae51f19748702986746d21d9c4a6d15626dff3bfbec9f47f0742f4f3d89babfd795c8d97cfb8c1726bafc8404f548b6330e68852d574fee24a118d3e49267612925e989e91dcdb77a8e2b52390054da64c242cfac8e1b0f789b3a57fecb5e9c9920812800356a4c01d94a053ee34662b380f2542b7d72ccdb995c82532d62f032ede8da373b67f1a6de35c14f3a8984a155954e819580f43fa13550e61ca6d417465878ba60250fd1c6364daf1586838825900c484f78ac8d0c7696a7fdba82555d36ed604245abf98bc6bf0bb34caa7e78ebd977632ad48e61176ab23ab9c56bb6370a5e887ee21aab553df12e782072db0b07fb443836d1c9c60318528811e27a9a007a647265347e92a27e647678a70737c71dcc6becf0c6e93836b5a45ee03995a64977e2848403effd8f7efe9e901020b749bf4e2e27a36f1070e452cb44fe9bc568404573298f127e5cd32699b993da8'
    content = AESDecrypt.decrypt(c)
    print(content)